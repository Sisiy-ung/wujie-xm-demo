{"version":3,"file":"shadow.js","names":["WUJIE_APP_ID","WUJIE_IFRAME_CLASS","WUJIE_SHADE_STYLE","CONTAINER_POSITION_DATA_FLAG","CONTAINER_OVERFLOW_DATA_FLAG","LOADING_DATA_FLAG","WUJIE_LOADING_STYLE","WUJIE_LOADING_SVG","getWujieById","rawAppendChild","rawElementAppendChild","rawElementRemoveChild","relativeElementTagAttrMap","getExternalStyleSheets","patchElementEffect","patchRenderEffect","getCssLoader","getPresetLoaders","getAbsolutePath","getContainer","getCurUrl","setAttrsToElement","cssSelectorMap","defineWujieWebComponent","customElements","window","get","WujieApp","_HTMLElement","_classCallCheck","_callSuper","arguments","_inherits","_createClass","key","value","connectedCallback","shadowRoot","attachShadow","mode","sandbox","getAttribute","iframe","contentWindow","disconnectedCallback","unmount","_wrapNativeSuper","HTMLElement","define","createWujieWebComponent","id","contentElement","document","createElement","setAttribute","classList","add","renderElementToContainer","element","selectorOrElement","container","contains","querySelector","concat","clearChild","call","initRenderIframeAndContainer","parent","degradeAttrs","length","undefined","createIframeContainer","contentDocument","open","write","close","processCssLoaderForTemplate","_x","_x2","_processCssLoaderForTemplate","apply","_asyncToGenerator","_regeneratorRuntime","mark","_callee","html","plugins","replace","proxyLocation","cssLoader","cssBeforeLoaders","cssAfterLoaders","curUrl","wrap","_callee$","_context","prev","next","Promise","all","fetch","lifecycles","loadError","map","_ref","src","contentPromise","then","content","contentList","forEach","_ref2","styleElement","appendChild","createTextNode","head","body","insertBefore","firstChild","_ref3","_ref4","abrupt","sent","stop","replaceHeadAndBody","headElement","bodyElement","cloneNode","removeChild","parentNode","replaceChild","renderTemplateToHtml","iframeWindow","template","__WUJIE","alive","execFlag","parser","DOMParser","parsedDocument","parseFromString","parsedHtml","documentElement","sourceAttributes","attributes","innerHTML","i","name","ElementIterator","createTreeWalker","NodeFilter","SHOW_ELEMENT","nextElement","currentNode","relativeAttr","tagName","url","baseURI","nextNode","renderTemplateToShadowRoot","_x3","_x4","_x5","_renderTemplateToShadowRoot","_callee2","processedHtml","shade","_callee2$","_context2","Object","defineProperty","enumerable","configurable","defaultStyle","_objectSpread","_defineProperty","style","join","renderTemplateToIframe","_x6","_x7","_x8","_renderTemplateToIframe","_callee3","renderDocument","_callee3$","_context3","root","addLoading","el","loading","containerStyles","getComputedStyle","_unused","position","overflow","setProperty","includes","loadingContainer","removeLoading","positionFlag","overflowFlag","removeProperty","removeAttribute","getPatchStyleElements","rootStyleSheets","rootCssRules","fontCssRules","rootStyleReg","_rootStyleSheets$i$cs","_rootStyleSheets$i","cssRules","j","cssRuleText","cssText","test","push","match","type","CSSRule","FONT_FACE_RULE","rootStyleSheetElement","fontStyleSheetElement"],"sources":["../src/shadow.ts"],"sourcesContent":["import {\n  WUJIE_APP_ID,\n  WUJIE_IFRAME_CLASS,\n  WUJIE_SHADE_STYLE,\n  CONTAINER_POSITION_DATA_FLAG,\n  CONTAINER_OVERFLOW_DATA_FLAG,\n  LOADING_DATA_FLAG,\n  WUJIE_LOADING_STYLE,\n  WUJIE_LOADING_SVG,\n} from \"./constant\";\nimport {\n  getWujieById,\n  rawAppendChild,\n  rawElementAppendChild,\n  rawElementRemoveChild,\n  relativeElementTagAttrMap,\n} from \"./common\";\nimport { getExternalStyleSheets } from \"./entry\";\nimport Wujie from \"./sandbox\";\nimport { patchElementEffect } from \"./iframe\";\nimport { patchRenderEffect } from \"./effect\";\nimport { getCssLoader, getPresetLoaders } from \"./plugin\";\nimport { getAbsolutePath, getContainer, getCurUrl, setAttrsToElement } from \"./utils\";\n\nconst cssSelectorMap = {\n  \":root\": \":host\",\n};\n\ndeclare global {\n  interface ShadowRoot {\n    head: HTMLHeadElement;\n    body: HTMLBodyElement;\n  }\n}\n\n/**\n * 定义 wujie webComponent，将shadow包裹并获得dom装载和卸载的生命周期\n */\nexport function defineWujieWebComponent() {\n  const customElements = window.customElements;\n  if (customElements && !customElements?.get(\"wujie-app\")) {\n    class WujieApp extends HTMLElement {\n      connectedCallback(): void {\n        if (this.shadowRoot) return;\n        const shadowRoot = this.attachShadow({ mode: \"open\" });\n        const sandbox = getWujieById(this.getAttribute(WUJIE_APP_ID));\n        patchElementEffect(shadowRoot, sandbox.iframe.contentWindow);\n        sandbox.shadowRoot = shadowRoot;\n      }\n\n      disconnectedCallback(): void {\n        const sandbox = getWujieById(this.getAttribute(WUJIE_APP_ID));\n        sandbox?.unmount();\n      }\n    }\n    customElements?.define(\"wujie-app\", WujieApp);\n  }\n}\n\nexport function createWujieWebComponent(id: string): HTMLElement {\n  const contentElement = window.document.createElement(\"wujie-app\");\n  contentElement.setAttribute(WUJIE_APP_ID, id);\n  contentElement.classList.add(WUJIE_IFRAME_CLASS);\n  return contentElement;\n}\n\n/**\n * 将准备好的内容插入容器\n */\nexport function renderElementToContainer(\n  element: Element | ChildNode,\n  selectorOrElement: string | HTMLElement\n): HTMLElement {\n  const container = getContainer(selectorOrElement);\n  if (container && !container.contains(element)) {\n    // 有 loading 无需清理，已经清理过了\n    if (!container.querySelector(`div[${LOADING_DATA_FLAG}]`)) {\n      // 清除内容\n      clearChild(container);\n    }\n    // 插入元素\n    if (element) {\n      rawElementAppendChild.call(container, element);\n    }\n  }\n  return container;\n}\n\n/**\n * 将降级的iframe挂在到容器上并进行初始化\n */\nexport function initRenderIframeAndContainer(\n  id: string,\n  parent: string | HTMLElement,\n  degradeAttrs: { [key: string]: any } = {}\n): { iframe: HTMLIFrameElement; container: HTMLElement } {\n  const iframe = createIframeContainer(id, degradeAttrs);\n  const container = renderElementToContainer(iframe, parent);\n  const contentDocument = iframe.contentWindow.document;\n  contentDocument.open();\n  contentDocument.write(\"<!DOCTYPE html><html><head></head><body></body></html>\");\n  contentDocument.close();\n  return { iframe, container };\n}\n\n/**\n * 处理css-before-loader 以及 css-after-loader\n */\nasync function processCssLoaderForTemplate(sandbox: Wujie, html: HTMLHtmlElement): Promise<HTMLHtmlElement> {\n  const document = sandbox.iframe.contentDocument;\n  const { plugins, replace, proxyLocation } = sandbox;\n  const cssLoader = getCssLoader({ plugins, replace });\n  const cssBeforeLoaders = getPresetLoaders(\"cssBeforeLoaders\", plugins);\n  const cssAfterLoaders = getPresetLoaders(\"cssAfterLoaders\", plugins);\n  const curUrl = getCurUrl(proxyLocation);\n\n  return await Promise.all([\n    Promise.all(\n      getExternalStyleSheets(cssBeforeLoaders, sandbox.fetch, sandbox.lifecycles.loadError).map(\n        ({ src, contentPromise }) => contentPromise.then((content) => ({ src, content }))\n      )\n    ).then((contentList) => {\n      contentList.forEach(({ src, content }) => {\n        if (!content) return;\n        const styleElement = document.createElement(\"style\");\n        styleElement.setAttribute(\"type\", \"text/css\");\n        styleElement.appendChild(document.createTextNode(content ? cssLoader(content, src, curUrl) : content));\n        const head = html.querySelector(\"head\");\n        const body = html.querySelector(\"body\");\n        html.insertBefore(styleElement, head || body || html.firstChild);\n      });\n    }),\n    Promise.all(\n      getExternalStyleSheets(cssAfterLoaders, sandbox.fetch, sandbox.lifecycles.loadError).map(\n        ({ src, contentPromise }) => contentPromise.then((content) => ({ src, content }))\n      )\n    ).then((contentList) => {\n      contentList.forEach(({ src, content }) => {\n        if (!content) return;\n        const styleElement = document.createElement(\"style\");\n        styleElement.setAttribute(\"type\", \"text/css\");\n        styleElement.appendChild(document.createTextNode(content ? cssLoader(content, src, curUrl) : content));\n        html.appendChild(styleElement);\n      });\n    }),\n  ]).then(\n    () => html,\n    () => html\n  );\n}\n\n// 替换html的head和body\nfunction replaceHeadAndBody(html: HTMLHtmlElement, head: HTMLHeadElement, body: HTMLBodyElement): HTMLHtmlElement {\n  const headElement = html.querySelector(\"head\");\n  const bodyElement = html.querySelector(\"body\");\n  if (headElement) {\n    while (headElement.firstChild) {\n      rawAppendChild.call(head, headElement.firstChild.cloneNode(true));\n      headElement.removeChild(headElement.firstChild);\n    }\n    headElement.parentNode.replaceChild(head, headElement);\n  }\n  if (bodyElement) {\n    while (bodyElement.firstChild) {\n      rawAppendChild.call(body, bodyElement.firstChild.cloneNode(true));\n      bodyElement.removeChild(bodyElement.firstChild);\n    }\n    bodyElement.parentNode.replaceChild(body, bodyElement);\n  }\n  return html;\n}\n\n/**\n * 将template渲染成html元素\n */\nfunction renderTemplateToHtml(iframeWindow: Window, template: string): HTMLHtmlElement {\n  const sandbox = iframeWindow.__WUJIE;\n  const { head, body, alive, execFlag } = sandbox;\n  const document = iframeWindow.document;\n  const parser = new DOMParser();\n  const parsedDocument = parser.parseFromString(template, \"text/html\");\n\n  // 无论 template 是否包含html，documentElement 必然是 HTMLHtmlElement\n  const parsedHtml = parsedDocument.documentElement as HTMLHtmlElement;\n  const sourceAttributes = parsedHtml.attributes;\n  let html = document.createElement(\"html\");\n  html.innerHTML = template;\n  for (let i = 0; i < sourceAttributes.length; i++) {\n    html.setAttribute(sourceAttributes[i].name, sourceAttributes[i].value);\n  }\n  // 组件多次渲染，head和body必须一直使用同一个来应对被缓存的场景\n  if (!alive && execFlag) {\n    html = replaceHeadAndBody(html, head, body);\n  } else {\n    sandbox.head = html.querySelector(\"head\");\n    sandbox.body = html.querySelector(\"body\");\n  }\n  const ElementIterator = document.createTreeWalker(html, NodeFilter.SHOW_ELEMENT, null, false);\n  let nextElement = ElementIterator.currentNode as HTMLElement;\n  while (nextElement) {\n    patchElementEffect(nextElement, iframeWindow);\n    const relativeAttr = relativeElementTagAttrMap[nextElement.tagName];\n    const url = nextElement[relativeAttr];\n    if (relativeAttr) nextElement.setAttribute(relativeAttr, getAbsolutePath(url, nextElement.baseURI || \"\"));\n    nextElement = ElementIterator.nextNode() as HTMLElement;\n  }\n  if (!html.querySelector(\"head\")) {\n    const head = document.createElement(\"head\");\n    html.appendChild(head);\n  }\n  if (!html.querySelector(\"body\")) {\n    const body = document.createElement(\"body\");\n    html.appendChild(body);\n  }\n  return html;\n}\n\n/**\n * 将template渲染到shadowRoot\n */\nexport async function renderTemplateToShadowRoot(\n  shadowRoot: ShadowRoot,\n  iframeWindow: Window,\n  template: string\n): Promise<void> {\n  const html = renderTemplateToHtml(iframeWindow, template);\n  // 处理 css-before-loader 和 css-after-loader\n  const processedHtml = await processCssLoaderForTemplate(iframeWindow.__WUJIE, html);\n  // change ownerDocument\n  shadowRoot.appendChild(processedHtml);\n  const shade = document.createElement(\"div\");\n  shade.setAttribute(\"style\", WUJIE_SHADE_STYLE);\n  processedHtml.insertBefore(shade, processedHtml.firstChild);\n  shadowRoot.head = shadowRoot.querySelector(\"head\");\n  shadowRoot.body = shadowRoot.querySelector(\"body\");\n\n  // 修复 html parentNode\n  Object.defineProperty(shadowRoot.firstChild, \"parentNode\", {\n    enumerable: true,\n    configurable: true,\n    get: () => iframeWindow.document,\n  });\n\n  patchRenderEffect(shadowRoot, iframeWindow.__WUJIE.id, false);\n}\n\nexport function createIframeContainer(id: string, degradeAttrs: { [key: string]: any } = {}): HTMLIFrameElement {\n  const iframe = document.createElement(\"iframe\");\n  const defaultStyle = \"height:100%;width:100%\";\n  setAttrsToElement(iframe, {\n    ...degradeAttrs,\n    style: [defaultStyle, degradeAttrs.style].join(\";\"),\n    [WUJIE_APP_ID]: id,\n  });\n  return iframe;\n}\n\n/**\n * 将template渲染到iframe\n */\nexport async function renderTemplateToIframe(\n  renderDocument: Document,\n  iframeWindow: Window,\n  template: string\n): Promise<void> {\n  // 插入template\n  const html = renderTemplateToHtml(iframeWindow, template);\n  // 处理 css-before-loader 和 css-after-loader\n  const processedHtml = await processCssLoaderForTemplate(iframeWindow.__WUJIE, html);\n  renderDocument.replaceChild(processedHtml, renderDocument.documentElement);\n\n  // 修复 html parentNode\n  Object.defineProperty(renderDocument.documentElement, \"parentNode\", {\n    enumerable: true,\n    configurable: true,\n    get: () => iframeWindow.document,\n  });\n\n  patchRenderEffect(renderDocument, iframeWindow.__WUJIE.id, true);\n}\n\n/**\n * 清除Element所有节点\n */\nexport function clearChild(root: ShadowRoot | Node): void {\n  // 清除内容\n  while (root?.firstChild) {\n    rawElementRemoveChild.call(root, root.firstChild);\n  }\n}\n\n/**\n * 给容器添加loading\n */\nexport function addLoading(el: string | HTMLElement, loading: HTMLElement): void {\n  const container = getContainer(el);\n  clearChild(container);\n  // 给容器设置一些样式，防止 loading 抖动\n  let containerStyles = null;\n  try {\n    containerStyles = window.getComputedStyle(container);\n  } catch {\n    return;\n  }\n  if (containerStyles.position === \"static\") {\n    container.setAttribute(CONTAINER_POSITION_DATA_FLAG, containerStyles.position);\n    container.setAttribute(\n      CONTAINER_OVERFLOW_DATA_FLAG,\n      containerStyles.overflow === \"visible\" ? \"\" : containerStyles.overflow\n    );\n    container.style.setProperty(\"position\", \"relative\");\n    container.style.setProperty(\"overflow\", \"hidden\");\n  } else if ([\"relative\", \"sticky\"].includes(containerStyles.position)) {\n    container.setAttribute(\n      CONTAINER_OVERFLOW_DATA_FLAG,\n      containerStyles.overflow === \"visible\" ? \"\" : containerStyles.overflow\n    );\n    container.style.setProperty(\"overflow\", \"hidden\");\n  }\n  const loadingContainer = document.createElement(\"div\");\n  loadingContainer.setAttribute(LOADING_DATA_FLAG, \"\");\n  loadingContainer.setAttribute(\"style\", WUJIE_LOADING_STYLE);\n  if (loading) loadingContainer.appendChild(loading);\n  else loadingContainer.innerHTML = WUJIE_LOADING_SVG;\n  container.appendChild(loadingContainer);\n}\n/**\n * 移除loading\n */\nexport function removeLoading(el: HTMLElement): void {\n  // 去除容器设置的样式\n  const positionFlag = el.getAttribute(CONTAINER_POSITION_DATA_FLAG);\n  const overflowFlag = el.getAttribute(CONTAINER_OVERFLOW_DATA_FLAG);\n  if (positionFlag) el.style.removeProperty(\"position\");\n  if (overflowFlag !== null) {\n    overflowFlag ? el.style.setProperty(\"overflow\", overflowFlag) : el.style.removeProperty(\"overflow\");\n  }\n  el.removeAttribute(CONTAINER_POSITION_DATA_FLAG);\n  el.removeAttribute(CONTAINER_OVERFLOW_DATA_FLAG);\n  const loadingContainer = el.querySelector(`div[${LOADING_DATA_FLAG}]`);\n  loadingContainer && el.removeChild(loadingContainer);\n}\n/**\n * 获取修复好的样式元素\n * 主要是针对对root样式和font-face样式\n */\nexport function getPatchStyleElements(rootStyleSheets: Array<CSSStyleSheet>): Array<HTMLStyleElement | null> {\n  const rootCssRules = [];\n  const fontCssRules = [];\n  const rootStyleReg = /:root/g;\n\n  // 找出root的cssRules\n  for (let i = 0; i < rootStyleSheets.length; i++) {\n    const cssRules = rootStyleSheets[i]?.cssRules ?? [];\n    for (let j = 0; j < cssRules.length; j++) {\n      const cssRuleText = cssRules[j].cssText;\n      // 如果是root的cssRule\n      if (rootStyleReg.test(cssRuleText)) {\n        rootCssRules.push(cssRuleText.replace(rootStyleReg, (match) => cssSelectorMap[match]));\n      }\n      // 如果是font-face的cssRule\n      if (cssRules[j].type === CSSRule.FONT_FACE_RULE) {\n        fontCssRules.push(cssRuleText);\n      }\n    }\n  }\n\n  let rootStyleSheetElement = null;\n  let fontStyleSheetElement = null;\n\n  // 复制到host上\n  if (rootCssRules.length) {\n    rootStyleSheetElement = window.document.createElement(\"style\");\n    rootStyleSheetElement.innerHTML = rootCssRules.join(\"\");\n  }\n\n  if (fontCssRules.length) {\n    fontStyleSheetElement = window.document.createElement(\"style\");\n    fontStyleSheetElement.innerHTML = fontCssRules.join(\"\");\n  }\n\n  return [rootStyleSheetElement, fontStyleSheetElement];\n}\n"],"mappings":"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","ignoreList":[]}